<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Pixelated Drum Pad</title>
    <style>
      body {
        image-rendering: pixelated;
        image-rendering: crisp-edges;
        filter: url(#pixelate);
        font-family: "Courier New", monospace;
        display: flex;
        flex-direction: column;
        align-items: center;
        background-color: #000;
        color: #0f0;
      }
      .drumpad {
        width: 100px;
        height: 100px;
        margin: 10px;
        cursor: pointer;
        border: 4px solid #0f0;
      }
      #kickPad {
        background-color: #00f;
      }
      #snarePad {
        background-color: #f00;
      }
      .active {
        filter: brightness(2);
      }
      .svg-filter {
        position: absolute;
        width: 0;
        height: 0;
      }
      h1 {
        font-size: 100px;
      }
      @media (max-width: 768px) {
        .drumpad {
          width: 150px;
          height: 150px;
          margin: 20px;
        }
        h1 {
          font-size: 40px;
        }
      }
    </style>
  </head>
  <body>
    <svg xmlns="http://www.w3.org/2000/svg" class="svg-filter">
      <filter id="pixelate" x="0" y="0">
        <feFlood x="4" y="4" height="2" width="2" />
        <feComposite width="8" height="8" />
        <feTile result="a" />
        <feComposite in="SourceGraphic" in2="a" operator="in" />
        <feMorphology operator="dilate" radius="1" />
      </filter>
    </svg>

    <h1>Pixelated Drum Pad</h1>
    <div id="drumPadContainer">
      <div class="drumpad" id="kickPad"></div>
      <div class="drumpad" id="snarePad"></div>
    </div>

    <script>
      // Create an audio context
      const audioContext = new (window.AudioContext || window.webkitAudioContext)();

      const pads = {
        kickPad: {
          url: "didimi mogoya.mp3",
          key: "KeyQ",
        },
        snarePad: {
          url: "Clap Chardro 1.wav",
          key: "KeyW",
        },
      };

      // Function to load an audio file and store it in a buffer
      async function loadSound(url) {
        const response = await fetch(url);
        const arrayBuffer = await response.arrayBuffer();
        return await audioContext.decodeAudioData(arrayBuffer);
      }

      // Load all sounds
      async function loadAllSounds() {
        for (let padId in pads) {
          pads[padId].buffer = await loadSound(pads[padId].url);
        }
      }

      // Function to play a sound
      function playSound(padId) {
        const source = audioContext.createBufferSource();
        source.buffer = pads[padId].buffer;
        source.connect(audioContext.destination);
        source.start(0);
        pads[padId].source = source;
      }

      // Function to stop a sound
      function stopSound(padId) {
        if (pads[padId].source) {
          pads[padId].source.stop(0);
        }
      }

      // Function to handle pad activation
      function handlePad(padId, isActive) {
        const pad = document.getElementById(padId);
        if (isActive) {
          playSound(padId);
          pad.classList.add("active");
        } else {
          stopSound(padId);
          pad.classList.remove("active");
        }
      }

      // Set up event listeners once sounds are loaded
      loadAllSounds().then(() => {
        for (let padId in pads) {
          const pad = document.getElementById(padId);
          
          // Touch events (for mobile)
          pad.addEventListener("touchstart", (e) => {
            e.preventDefault();
            handlePad(padId, true);
          });
          pad.addEventListener("touchend", (e) => {
            e.preventDefault();
            handlePad(padId, false);
          });
          
          // Mouse events (for desktop)
          pad.addEventListener("mousedown", () => handlePad(padId, true));
          pad.addEventListener("mouseup", () => handlePad(padId, false));
          pad.addEventListener("mouseleave", () => handlePad(padId, false));
        }

        // Keyboard events (for desktop)
        document.addEventListener("keydown", (event) => {
          if (event.repeat) return;
          for (let padId in pads) {
            if (event.code === pads[padId].key) handlePad(padId, true);
          }
        });

        document.addEventListener("keyup", (event) => {
          for (let padId in pads) {
            if (event.code === pads[padId].key) handlePad(padId, false);
          }
        });
      });

      // Resume audio context on user interaction (to handle autoplay policy)
      document.body.addEventListener('touchstart', function() {
        if (audioContext.state !== 'running') {
          audioContext.resume();
        }
      }, false);
    </script>
  </body>
</html>
